##Chapter2 Linuxのインストールとパッケージ管理
- **内容**
  - **ハードウェアディスクのレイアウト設計**
  - **ブートマネージャのインストール**
  - **共有ライブラリ管理**
  - **Debianパッケージの管理**
  - **RPMパッケージの管理**



####Linuxインストールに必要なパーティション

- スワップ領域
  - メモリサイズと同程度〜2倍程度のサイズを割り当てる
- 用途が異なるディレクトリは別のパーティションを配置するようにする

####ブートマネージャのインストール

- ブートマネージャー
  - **MBR(マスターブートレコード)**から起動プログラムを読み込む
    - 第一段階のブローダ
    - 第二段階のブローダ
      - MBRのサイズが小さいために2段階に分けている
  - 代表的なブローダ
    - **GRUB**
    - **LILO**


- **GRUB**
  - 多機能ブートローダ
    - 多数のファイルシステムを認識可能
    - シェル機能を搭載し、コマンドによる高度な管理が可能
    - `grub-install`コマンド

[/dev/sdaのMBR領域にGRUBをインストール]
```
# grub-install /dev/sda
```

- GRUBの設定ファイル
  - `/boot/grub/menu.lst` 

`# cat /boot/grub/menu.lst`
```
default=0
timeout=0
hiddenmenu
title CentOS (2.6.32-431.3.1.el6.x86_64)
	root (hd0,0)
	kernel /boot/vmlinuz-2.6.32-431.3.1.el6.x86_64 ro root=UUID=1d798f26-8ace-413f-9530-2d1d1d4fdbb5 rd_NO_LUKS  KEYBOARDTYPE=pc KEYTABLE=us LANG=en_US.UTF-8 clocksource_failover=acpi_pm rd_NO_MD SYSFONT=latarcyrheb-sun16 crashkernel=auto rd_NO_LVM rd_NO_DM
	initrd /boot/initramfs-2.6.32-431.3.1.el6.x86_64.img
```

- **LILO**
  - Intelアーキテクチャ用のブローダ
  -　**ブローダ**
    - BIOSによって実行され、Linuxカーネルや他のOSをメモリ上に読み混む役割
  - **マップインストーラ**
    - ブートセクタを更新
    - マップファイルを作する
    - `/sbin/lilo`
  - **マップファイル**
    - ディスク上の物理的なカーネルの位置を記録したファイル 
  - **LILO設定ファイル**
    - `/etc/lilo.conf`

- 共有ライブラリの確認
  - 実行ファイルが必要としている共有ライブラリは`ldd`コマンドで調べられる
  - `/lib`
  - `/usr/lib`
  - `/etc/ld.so.conf`ファイルに記述する
  - 実際にはバイナリのキャッシュファイルが参照される
    - `/etc/ld.so.cache`
  - `ldconfig`コマンドは`/etc/ld.so.conf`ファイルに基づいて、`/etc/ld.so.cache`を再構築する
  - その他のディレクトリも検索対象に加えたい場合は`環境変数 LD_LIBRARY_PATH`に記述する
  

**ディレクトリのまとめ**

|ディレクトリ|分割適否  |説明         |
|:-----------|:------------|:------------|
|/home|◯|一般ユーザのホームディレクトリ(書き込みが頻繁に発生)|
|/usr|◯|起動には不要なプログラムを格納(読み込みが頻繁に発生)|
|/var|◯|ログファイルやメールなど可変ファイル群を格納(書き込みが頻繁に格納)|
|/boot|△|Linuxカーネルなど起動に必須のファイルを格納|
|/tmp|△|一時的なファイルを格納|
|/bin|×|一般ユーザのコマンドを格納|
|/sbin|×|管理者用のコマンドを格納|
|/etc|×|システムの設定ファイルを格納|
|/lib|×|共有ライブラリを格納|
|/dev|×|デバイスファイルを格納|



#### パッケージ管理

- パッケージ
  - 「実行プログラム」、「設定ファイル」、「ドキュメント」
  -　パッケージ管理システムで管理が容易
  -　Debian形式
    - dpkgコマンド、dselectコマンド、APTツール
　-　RPM形式
　  - rpmコマンド　
 
- **dpkgコマンド**
  - `dpkg -i` : インストール
  - `dpkg --purge` : 設定ファイルを含め、完全にアンインストール
  - `dpkg -S` : 指定したファイルがどのパッケージからインストールされたかを調べる
  - `dpkg -l` : インストール済みの全パッケージを表示する
  - `dpkg -L | --listfiles` : パッケージに含まれるファイルを表示する
  - `dpkg -s | --status` : パッケージ情報を表示する
	 
- **apt-getコマンド**
  - パッケージ管理
    - `/etc/apt/sources.list`
  - `apt-get dist-upgrade` : 既存の構成と矛盾することになるパッケージはアップグレードしない

- **apt-cacheコマンド**
　- パッケージ情報を照会、検索することができるコマンド
　- 照会、検索する対象のパッケージはインストールされていなくても良い

- **aptitudeコマンド**
　- `apt-getコマンド`よりも高度な機能を持ったコマンド
　- とりわけ、正規表現を使った検索機能が優れている
